machine:
  timezone:
    Europe/Paris
  php:
    version: 7.1.9

dependencies:
  pre:
    - sed -i 's/^;//' /opt/circleci/php/$(phpenv global)/etc/conf.d/xdebug.ini
    - rm /opt/circleci/php/$(phpenv global)/etc/conf.d/xdebug.ini
  override:
    - composer require --dev "symfony/symfony:3.4.*" --no-update
    - composer install --no-interaction --profile --no-progress
  cache_directories:
    - ~/.composer/cache

test:
  override:
    - mkdir -p $CIRCLE_TEST_REPORTS/phpunit
    - php ./vendor/bin/phpspec run --format=pretty
    - php ./vendor/bin/phpunit --log-junit $CIRCLE_TEST_REPORTS/phpunit/junit.xml
    - php ./vendor/bin/behat
